def create_outlook_email(recipients: list, subject: str = "", body: str = "", send_individually: bool = False):
    """
    Tworzy i wyświetla nową wiadomość e-mail w Outlook, pozwalając
    programowi Outlook na automatyczne wstawienie domyślnej stopki.
    """
    if not recipients:
        return False, "Brak zdefiniowanych odbiorców."
    
    outlook = _get_outlook_instance()
    if not outlook:
        return False, "Nie można połączyć się z programem Outlook. Upewnij się, że jest zainstalowany."

    try:
        mail = outlook.CreateItem(0)
        
        # Ustawiamy odbiorców
        if send_individually:
            mail.BCC = "; ".join(recipients)
        else:
            mail.To = "; ".join(recipients)

        mail.Subject = subject
        
        # WAŻNE: Celowo nie ustawiamy treści (mail.HTMLBody).
        # Wywołanie .Display() na wiadomości z pustą treścią
        # spowoduje, że Outlook automatycznie podstawi domyślną stopkę.
        
        mail.Display(True)

        return True, "OK"
    except Exception as e:
        log_error(f"Nie udało się stworzyć wiadomości e-mail w Outlook: {e}", exception=e)
        return False, f"Wystąpił błąd podczas tworzenia wiadomości: {e}"
