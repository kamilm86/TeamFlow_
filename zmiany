# W pliku: main.py

    def refresh_data(self):
        """Wymusza odświeżenie danych z bazy, zapisując stan filtrów i aktualizując widoczność przycisków."""
        self._save_current_filter_settings()

        self.refresh_button.setText("Odśwież")
        self.refresh_button.setStyleSheet(AppStyles.get_button_style("dark" if self.is_dark_theme else "light"))
        self.refresh_button.setToolTip("Odśwież dane")

        current_data = self.date_combo.currentData()
        if current_data:
            year, month = current_data

            # ZMIANA: Dodano wywołanie funkcji aktualizującej widoczność przycisków
            self.update_buttons_visibility()

            self.data_provider.clear_monthly_cache(year, month)
            self.update_data(year, month, self.import_grupa, self.import_funkcja, use_async=True)

            self.update_filter_dates()
            self._update_modification_date()
            if hasattr(self, 'check_timer'):
                self.check_timer.start(60000)
